// RUN: %clang_builtins %s %librt -o %t && %run %t
// REQUIRES: librt_has_divv2df3

#include <stdio.h>

// Returns: a % b

#define NELTS 2
typedef double elt_t;
typedef elt_t vector_t __attribute__((__vector_size__(NELTS * sizeof(elt_t))));
vector_t __divv2df3(vector_t a, vector_t b);

#define PRINTT "%.10lf"

int test__divv2df3(vector_t a, vector_t b, vector_t expected_r) {
  vector_t r = __divv2df3(a, b);
  int res = 0;
  for (int lane = 0; lane < (int)(sizeof(vector_t) / sizeof(elt_t)); ++lane)
    if (r[lane] != expected_r[lane]) {
      printf("error in __divv2df3 (lane %d): " PRINTT " / " PRINTT " = " PRINTT
             ", expected " PRINTT "\n",
             lane, a[lane], b[lane], r[lane], expected_r[lane]);
      res = 1;
    }
  return res;
}

vector_t tests[][3] = {
    {{8541.40180531448640977032, 37495.09902424819301813841},
     {4819.58278117837107856758, 43524.26135135377990081906},
     {1.77222846730026373230, 0.86147582658704768832}},
    {{28866.94756822268755058758, 39290.82441781029046978801},
     {39429.29045411038532620296, 61962.57484737483173375949},
     {0.73211937713714025922, 0.63410574067638059148}},
    {{43695.93596246758534107357, 37255.38902824393153423443},
     {61731.58590876597008900717, 79648.98500204359879717231},
     {0.70783757324891116713, 0.46774468032816801655}},
    {{36626.68943770020268857479, 13011.56779882433693273924},
     {81446.27465495983778964728, 118488.48256332441815175116},
     {0.44970368003774308097, 0.10981293301541351914}},
    {{42252.20658269433624809608, 28789.51983707183171645738},
     {117223.20441339300305116922, 122638.69486701824644114822},
     {0.36044234410867997953, 0.23475070301660819205}},
    {{22791.61687533197982702404, 5497.57545973528885951964},
     {144484.60560422166599892080, 142173.02339945200947113335},
     {0.15774425780531761698, 0.03866820391298282644}},
    {{28429.42890498016276978888, 47953.36114262268529273570},
     {187870.56042717851232737303, 150332.49891206994652748108},
     {0.15132455473778097521, 0.31898199983139235991}},
    {{13775.59766797052543552127, 13018.37372560318908654153},
     {234075.29752063678461126983, 172128.63076720418757759035},
     {0.05885113813325828364, 0.07563165795009385572}},
    {{39473.10212874265562277287, 6380.92647224496613489464},
     {238185.58182265853974968195, 219160.73158959648571908474},
     {0.16572414596502493822, 0.02911528185712566538}},
    {{1278.91203679686736904841, 7710.57568167308727424825},
     {257294.70308656635461375117, 226897.56657293110038153827},
     {0.00497061160394965309, 0.03398262836456950736}},
    {{26466.67587646062384010293, 43842.45853679092397214845},
     {278825.27500348631292581558, 240092.87789003507350571454},
     {0.09492208292856411933, 0.18260624355909135796}},
    {{15679.81987324362853541970, 38504.76689897971664322540},
     {284194.81915619154460728168, 278644.99064981733681634068},
     {0.05517278576646432453, 0.13818574957756901700}},
    {{35259.83311750820575980470, 10932.12112113748480624054},
     {322284.51879899133928120136, 299230.64292876515537500381},
     {0.10940591638998255208, 0.03653409628819326987}},
    {{32441.45055237203996512108, 46497.84927946463722037151},
     {347405.44707892485894262791, 333602.67690020852023735642},
     {0.09338210101524939410, 0.13938092377290384194}},
    {{21804.64078946740846731700, 30415.18477841077765333466},
     {376233.37876069330377504230, 365233.76243591197999194264},
     {0.05795509388691547081, 0.08327593970381576283}},
    {{23171.34033653101869276725, 31612.27275644403198384680},
     {383148.12539315962931141257, 413271.83333217154722660780},
     {0.06047619393349300959, 0.07649268642761661297}},
    {{7218.81053058598718052963, 22334.23004607548500644043},
     {399377.34838542860234156251, 460901.03721179498825222254},
     {0.01807516264948332008, 0.04845775609702604458}},
    {{17909.21359922150077181868, 19910.45958236827937071212},
     {404441.42549704771954566240, 508655.32399443897884339094},
     {0.04428135317051549308, 0.03914332288122468473}},
    {{49230.89166490691422950476, 28798.54321589723986107856},
     {447737.11226631066529080272, 516149.11855607770849019289},
     {0.10995490504621102668, 0.05579500609525575583}},
    {{45457.63146898802369832993, 32562.68122700817548320629},
     {450930.15500455675646662712, 563899.08788420050404965878},
     {0.10080858635086993591, 0.05774558236862246258}},
    {{48313.23902236926369369030, 39277.22700628085294738412},
     {491188.39589930680813267827, 592461.77187398809473961592},
     {0.09835989495214669809, 0.06629495584507485995}},
    {{14129.38435760719039535616, 48127.61889335402520373464},
     {520162.24884662212571129203, 614304.70322251657489687204},
     {0.02716341754699976019, 0.07834486475666944949}},
    {{18771.83589028125061304308, 46170.45880451578705105931},
     {521597.21784977777861058712, 652747.70210829155985265970},
     {0.03598914113780342372, 0.07073247237085801553}},
    {{36155.37457502041070256382, 29548.53822312064949073829},
     {542891.64477876969613134861, 684854.85506244248244911432},
     {0.06659777309660724898, 0.04314569430982061887}},
    {{37338.20305280446336837485, 3450.97063639947873525671},
     {545556.39220988785382360220, 723570.53734100982546806335},
     {0.06844059310084962822, 0.00476936312122542769}},
    {{35175.24247756753175053746, 6063.32734709046962962020},
     {560728.23780814942438155413, 727295.93001526314765214920},
     {0.06273135559404907635, 0.00833680912660026037}},
    {{34393.05205913038662401959, 18247.81382522344210883602},
     {597200.44275435595773160458, 737025.23585419321898370981},
     {0.05759046644457552905, 0.02475873679423567716}},
    {{7729.66688025978237419622, 8089.64423192812864726875},
     {638812.08715448190923780203, 764572.08395055111031979322},
     {0.01210006359568231195, 0.01058061679433659232}},
    {{15857.16361618796327093150, 26386.82917852884929743595},
     {660473.18492858228273689747, 775256.00713436515070497990},
     {0.02400879245067703491, 0.03403627825608781382}},
    {{36480.25490627782710362226, 68.49916051560515484198},
     {689783.40971098165027797222, 799127.90684607380535453558},
     {0.05288653567583338766, 0.00008571739258356210}},
    {{46992.95132424213807098567, 38107.92821898908005096018},
     {696170.10777974431402981281, 799866.81875057006254792213},
     {0.06750211018699737997, 0.04764284169021471699}},
    {{24999.73554039464943343773, 42238.62445036827557487413},
     {738777.53557288472075015306, 804417.24353388766758143902},
     {0.03383932826410133987, 0.05250835283541369081}},
    {{42887.66775017401960212737, 39446.76342793439835077152},
     {767701.34516802139114588499, 809391.69873126968741416931},
     {0.05586504181621239351, 0.04873630837796783660}},
    {{41408.44276884505961788818, 37359.87695323453954188153},
     {813119.92405276943463832140, 834998.81990926899015903473},
     {0.05092538203031138355, 0.04474243084235025175}},
    {{44228.34399637868045829237, 48097.41640882335923379287},
     {841445.46407166915014386177, 858693.33701064379420131445},
     {0.05256234169040761850, 0.05601233215138733124}},
    {{20877.89545301373800612055, 32517.31306565832710475661},
     {885455.54270342329982668161, 887990.07123944570776075125},
     {0.02357870547545562467, 0.03661900523310025052}},
    {{11125.62886649053143628407, 49967.36796419883467024192},
     {893414.51752622553613036871, 922769.93971016467548906803},
     {0.01245293046871039609, 0.05414932348131454992}},
    {{35076.48009923430072376505, 49310.33680101167556131259},
     {925844.39722056919708848000, 955513.97252940386533737183},
     {0.03788593440165068105, 0.05160608658655094216}},
    {{42210.23983187618432566524, 34088.54327465895767090842},
     {974351.81071469548624008894, 972096.89646662713494151831},
     {0.04332135412250592149, 0.03506702202070989538}},
    {{40004.15196592041320400313, 7968.24537250346929795342},
     {1017515.76669932843651622534, 1002234.73047235794365406036},
     {0.03931551065364618375, 0.00795047819660769234}},
    {{20997.98389391940872883424, 49067.86184419425990199670},
     {1060960.61095212120562791824, 1025436.58371312764938920736},
     {0.01979148299867185268, 0.04785070342089658285}},
    {{12342.19938362552056787536, 42231.97492436636821366847},
     {1103122.74656986072659492493, 1062261.91233278508298099041},
     {0.01118841889717473066, 0.03975664987519193783}},
    {{6609.75065331825317116454, 23840.28805455961264669895},
     {1142339.59578451095148921013, 1087141.54576480016112327576},
     {0.00578615210197537966, 0.02192933215314483639}},
    {{28440.92637751344227581285, 22203.04390968997176969424},
     {1144101.03063918231055140495, 1103733.95918023493140935898},
     {0.02485875426720327713, 0.02011630042277634881}},
    {{21331.52029294837120687589, 29128.52891498827011673711},
     {1148504.17814865545369684696, 1137478.37075642636045813560},
     {0.01857330665294919594, 0.02560798487589501654}},
    {{29371.82618358529725810513, 11785.41725038096774369478},
     {1185736.47401772555895149708, 1185396.05921244341880083084},
     {0.02477095613333238702, 0.00994217684358677037}},
    {{43212.79700440907618030906, 3721.51525847213633824140},
     {1212726.97351593314670026302, 1204536.80992435477674007416},
     {0.03563274994958404163, 0.00308958201012208894}},
    {{92.32706854089725823087, 35830.72357444416411453858},
     {1215409.87031077058054506779, 1205589.04147658520378172398},
     {0.00007596373108052016, 0.02972051200014168629}},
    {{37928.05752878912608139217, 31448.05432162635406712070},
     {1261960.58116975729353725910, 1232986.07642046827822923660},
     {0.03005486708121439532, 0.02550560377204296597}},
    {{20701.71696542950303410180, 19648.07833541693980805576},
     {1271839.54930643388070166111, 1248390.29111781599931418896},
     {0.01627698790835578960, 0.01573873048774188793}},
    {{10462.51689562766659946647, 30554.58411244415037799627},
     {1290436.54024288896471261978, 1256422.80379126151092350483},
     {0.00810773452963319506, 0.02431871183828051772}},
    {{23011.18198728118295548484, 40149.02658703451015753672},
     {1299607.85549346916377544403, 1292319.68435456953011453152},
     {0.01770625030466878302, 0.03106741085282343703}},
    {{23834.34139970305841416121, 7087.74681758635779260658},
     {1331290.79086739779449999332, 1304447.84445039392448961735},
     {0.01790318205699738957, 0.00543352258025513873}},
    {{6207.52980006643338128924, 43573.97728452824958367273},
     {1336461.30309369345195591450, 1342168.19470038171857595444},
     {0.00464475086985084978, 0.03246536272918869315}},
    {{19029.02249099154141731560, 27836.80751572041481267661},
     {1340373.22176661645062267780, 1361036.94491840223781764507},
     {0.01419680890514302130, 0.02045264650577821239}},
    {{31259.22556576734496047720, 39481.10720982782368082553},
     {1361441.21989541593939065933, 1402249.13152233324944972992},
     {0.02296039308121480133, 0.02815555832576318446}},
    {{27595.84994140651906491257, 36410.05636730456171790138},
     {1385881.91784499725326895714, 1415358.34729856462217867374},
     {0.01991212208347244855, 0.02572497377558052162}},
    {{24895.56434650932351360098, 24478.39495280346454819664},
     {1410456.99002580787055194378, 1457836.93784650671295821667},
     {0.01765070790712575804, 0.01679090048916071290}},
    {{45944.92678784066811203957, 18097.96594745565016637556},
     {1437746.53480834048241376877, 1488063.53540322510525584221},
     {0.03195620763152482585, 0.01216209222044513719}},
    {{30482.95146294552614563145, 22041.02583459084053174593},
     {1473082.58490171772427856922, 1498871.09639117540791630745},
     {0.02069330788061642112, 0.01470508430488713138}},
    {{38283.97819292349595343694, 15319.37028981382718484383},
     {1512394.82257342990487813950, 1503360.66914019570685923100},
     {0.02531348138826674046, 0.01019008319445745790}},
    {{44929.80934422175778308883, 46679.45817540026473579928},
     {1560763.93194999406114220619, 1534287.97112874640151858330},
     {0.02878706281230317479, 0.03042418310889779057}},
    {{3345.98216976717094439664, 5651.56221469121101108612},
     {1592296.69520266912877559662, 1537998.73221416887827217579},
     {0.00210135597206731039, 0.00367462085391642669}},
    {{27870.36272913984794286080, 11710.19890489197860006243},
     {1622894.81228994298726320267, 1584726.34624779666773974895},
     {0.01717324038383861995, 0.00738941390898091750}},
    {{28585.13134822504434850998, 28712.94561461577541194856},
     {1646116.40232587698847055435, 1590769.05589338392019271851},
     {0.01736519441021044247, 0.01804972601663441464}},
    {{11809.17979667108193098102, 49930.39603062503010733053},
     {1673977.40142211201600730419, 1633958.01520685339346528053},
     {0.00705456345267188329, 0.03055794308417650318}},
    {{14355.99691389602594426833, 36497.23221178759558824822},
     {1715040.29548796522431075573, 1658394.67553710471838712692},
     {0.00837064700559204088, 0.02200756716730728133}},
    {{29652.38240969768230570480, 5608.05773212840085761854},
     {1722955.27106914902105927467, 1693348.01964187971316277981},
     {0.01721018700113870550, 0.00331181639395924628}},
    {{29741.06955615893093636259, 44149.66119018772587878630},
     {1744510.40258777700364589691, 1703851.92677477747201919556},
     {0.01704837615874433068, 0.02591167723932363831}},
    {{9108.84217776815421530046, 34374.27977811945311259478},
     {1755416.65566605329513549805, 1717075.04120974312536418438},
     {0.00518899154133410558, 0.02001908999498443545}},
    {{11155.01767091488363803364, 24632.81714407262552413158},
     {1768807.52454993827268481255, 1739377.79467304958961904049},
     {0.00630651866644066101, 0.01416185558968967480}},
    {{11812.43072999736250494607, 14839.44515529519594565500},
     {1801339.05359869473613798618, 1776866.00902025285176932812},
     {0.00655758320811322161, 0.00835147111822884432}},
    {{34629.49678270927688572556, 21244.54866981913437484764},
     {1839316.85059812315739691257, 1796785.79192214459180831909},
     {0.01882736885243463734, 0.01182364017198309948}},
    {{18699.58111537591685191728, 32054.85100673769920831546},
     {1866007.78114103968255221844, 1841745.20112966722808778286},
     {0.01002116995671977623, 0.01740460677572353010}},
    {{32769.56411768391990335658, 46533.36999491446476895362},
     {1866499.15197471040301024914, 1850367.56101839919574558735},
     {0.01755669917289516199, 0.02514817648948816653}},
    {{32169.14846468676114454865, 38301.98541591653338400647},
     {1900315.92614308791235089302, 1888891.99063888471573591232},
     {0.01692831598268914467, 0.02027748839305605622}},
    {{37774.05357664277107687667, 44796.79877321548701729625},
     {1911206.45867835916578769684, 1920721.97061508242040872574},
     {0.01976450707620795375, 0.02332289600398020427}},
    {{29859.47134359896517707966, 31115.93241185705119278282},
     {1929466.25887308176606893539, 1924267.91525984252803027630},
     {0.01547550842430310200, 0.01617027034806394273}},
    {{12624.43878744656285562087, 18055.07770343151423730887},
     {1953647.74976760381832718849, 1949453.20765892812050879002},
     {0.00646198312308260414, 0.00926161122128887210}},
    {{14495.54575751505763037130, 11935.59216423808356921654},
     {1986772.04901911807246506214, 1994337.93378396145999431610},
     {0.00729602863331583508, 0.00598473907658771814}},
    {{33572.50990950980485649779, 2159.09467772338894064887},
     {2028652.59500512247905135155, 2022939.25462512345984578133},
     {0.01654916666962636534, 0.00106730573979765733}},
    {{9191.79198341933806659654, 1322.00528685351855529007},
     {2052418.41070684883743524551, 2051097.57370678777806460857},
     {0.00447851760414373981, 0.00064453554223866695}},
    {{8394.86084907110853237100, 30521.97952517810699646361},
     {2084523.87409390253014862537, 2066417.18510881275869905949},
     {0.00402723180741701697, 0.01477048281689105798}},
    {{47839.20398845121962949634, 38297.66726245760219171643},
     {2116323.75149152521044015884, 2069852.17133329482749104500},
     {0.02260486088422695300, 0.01850260989304765985}},
    {{6532.68171314330811583204, 37856.23069029387261252850},
     {2140339.66948308516293764114, 2105586.91122648445889353752},
     {0.00305217055324728901, 0.01797894472484300177}},
    {{5763.27826275177358184010, 32033.42616002248541917652},
     {2160257.13663419801741838455, 2140901.55900861835107207298},
     {0.00266786678540096613, 0.01496258715176802465}},
    {{39198.14922589847265044227, 35253.29007081079907948151},
     {2173684.17969783488661050797, 2179925.37272592168301343918},
     {0.01803304711512756717, 0.01617178758130044178}},
    {{6707.13194553857283608522, 13846.07703734890856139828},
     {2177746.89657345227897167206, 2190588.36368931503966450691},
     {0.00307984915790343811, 0.00632071148868416921}},
    {{9804.50680688036845822353, 30960.38124421098837046884},
     {2208083.03237414220348000526, 2218053.67039871169254183769},
     {0.00444027994560445161, 0.01395835531727490988}},
    {{28376.80921064682843280025, 6268.17513493001115421066},
     {2211683.60335561353713274002, 2262195.54689054517075419426},
     {0.01283041080902934221, 0.00277083700546833971}},
    {{7663.82648262163547769887, 28288.85737301221161033027},
     {2227514.68965602992102503777, 2278935.31533462414517998695},
     {0.00344052792029177342, 0.01241319013429675183}},
    {{10279.61295389433689706493, 33813.33688226179219782352},
     {2229501.62088793283328413963, 2281053.93811489129438996315},
     {0.00461072235049567961, 0.01482355867051781025}},
    {{40798.10318724176613613963, 3231.53251260504111996852},
     {2264891.73333919793367385864, 2301529.59075246891006827354},
     {0.01801326861972863194, 0.00140408036706949940}},
    {{44392.46398813954874640331, 46983.92366885744559112936},
     {2265042.79423080710694193840, 2319068.29218883486464619637},
     {0.01959895155235463066, 0.02025982754673948463}},
    {{46921.39550996217440115288, 49571.17103963386034592986},
     {2282978.69312169775366783142, 2367905.00458737369626760483},
     {0.02055270846431020773, 0.02093461137317543380}},
    {{1317.23292545368872197287, 17054.44656152738753007725},
     {2325288.48474666802212595940, 2389815.83550323918461799622},
     {0.00056648150717402129, 0.00713630159620066290}},
    {{35176.04253745794267160818, 28530.11644082927887211554},
     {2330461.73854880128055810928, 2398858.94870972167700529099},
     {0.01509402276621901046, 0.01189320299810658725}},
    {{12011.16368618626620445866, 34212.50464506484422599897},
     {2379717.08077472727745771408, 2424539.35697447322309017181},
     {0.00504730742289582601, 0.01411092979235356246}},
    {{45044.79214671729278052226, 23340.92457844588716397993},
     {2403434.99371577845886349678, 2444915.97459630435332655907},
     {0.01874183918620439537, 0.00954671850524427788}},
    {{37924.58963861875236034393, 5751.23073457806185615482},
     {2410728.31760232988744974136, 2479872.64661315642297267914},
     {0.01573159006002713620, 0.00231916374513534270}},
    {{13009.65214766803364909720, 26510.35763535589285311289},
     {2414043.45351887354627251625, 2487313.54546956392005085945},
     {0.00538915408863261444, 0.01065822910973259451}},
    {{13009.65214766803364909720, 26510.35763535589285311289},
     {2414043.45351887354627251625, 2487313.54546956392005085945},
     {0.00538915408863261444, 0.01065822910973259451}},
};

int main() {
  const unsigned N = sizeof(tests) / sizeof(tests[0]);
  unsigned i;
  int r = 0;
  for (i = 0; i < N; ++i)
    r |= test__divv2df3(tests[i][0], tests[i][1], tests[i][2]);

  return r;
}
