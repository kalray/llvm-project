// NOTE: Assertions have been autogenerated by utils/update_cc_test_checks.py
// RUN: %clang_cc1 -triple kvx-kalray-cos -emit-llvm %s -Os -o - | FileCheck %s --check-prefixes=OPS
// RUN: %clang_cc1 -triple kvx-kalray-cos -emit-llvm %s -Oz -o - | FileCheck %s --check-prefixes=OPZ
// RUN: %clang_cc1 -triple kvx-kalray-cos -emit-llvm %s -O3 -o - | FileCheck %s --check-prefixes=OP3


// OPS-LABEL: @matrix_mul_const(
// OPS-NEXT:  entry:
// OPS-NEXT:    [[CMP26_NOT:%.*]] = icmp eq i32 [[N:%.*]], 0
// OPS-NEXT:    br i1 [[CMP26_NOT]], label [[FOR_END12:%.*]], label [[FOR_COND1_PREHEADER_LR_PH:%.*]]
// OPS:       for.cond1.preheader.lr.ph:
// OPS-NEXT:    [[CONV4:%.*]] = sext i16 [[VAL:%.*]] to i32
// OPS-NEXT:    [[WIDE_TRIP_COUNT:%.*]] = zext i32 [[N]] to i64
// OPS-NEXT:    br label [[FOR_BODY3_LR_PH:%.*]]
// OPS:       for.body3.lr.ph:
// OPS-NEXT:    [[I_027:%.*]] = phi i32 [ 0, [[FOR_COND1_PREHEADER_LR_PH]] ], [ [[INC11:%.*]], [[FOR_INC10:%.*]] ]
// OPS-NEXT:    [[MUL:%.*]] = mul i32 [[I_027]], [[N]]
// OPS-NEXT:    br label [[FOR_BODY3:%.*]]
// OPS:       for.body3:
// OPS-NEXT:    [[INDVARS_IV:%.*]] = phi i64 [ 0, [[FOR_BODY3_LR_PH]] ], [ [[INDVARS_IV_NEXT:%.*]], [[FOR_BODY3]] ]
// OPS-NEXT:    [[TMP0:%.*]] = trunc i64 [[INDVARS_IV]] to i32
// OPS-NEXT:    [[ADD:%.*]] = add i32 [[MUL]], [[TMP0]]
// OPS-NEXT:    [[IDXPROM:%.*]] = zext i32 [[ADD]] to i64
// OPS-NEXT:    [[ARRAYIDX:%.*]] = getelementptr inbounds i16, i16* [[A:%.*]], i64 [[IDXPROM]]
// OPS-NEXT:    [[TMP1:%.*]] = load i16, i16* [[ARRAYIDX]], align 2, [[TBAA2:!tbaa !.*]]
// OPS-NEXT:    [[CONV:%.*]] = sext i16 [[TMP1]] to i32
// OPS-NEXT:    [[MUL5:%.*]] = mul nsw i32 [[CONV]], [[CONV4]]
// OPS-NEXT:    [[ARRAYIDX9:%.*]] = getelementptr inbounds i32, i32* [[C:%.*]], i64 [[IDXPROM]]
// OPS-NEXT:    store i32 [[MUL5]], i32* [[ARRAYIDX9]], align 4, [[TBAA6:!tbaa !.*]]
// OPS-NEXT:    [[INDVARS_IV_NEXT]] = add nuw nsw i64 [[INDVARS_IV]], 1
// OPS-NEXT:    [[EXITCOND_NOT:%.*]] = icmp eq i64 [[INDVARS_IV_NEXT]], [[WIDE_TRIP_COUNT]]
// OPS-NEXT:    br i1 [[EXITCOND_NOT]], label [[FOR_INC10]], label [[FOR_BODY3]], [[LOOP8:!llvm.loop !.*]]
// OPS:       for.inc10:
// OPS-NEXT:    [[INC11]] = add nuw i32 [[I_027]], 1
// OPS-NEXT:    [[EXITCOND29_NOT:%.*]] = icmp eq i32 [[INC11]], [[N]]
// OPS-NEXT:    br i1 [[EXITCOND29_NOT]], label [[FOR_END12]], label [[FOR_BODY3_LR_PH]], [[LOOP10:!llvm.loop !.*]]
// OPS:       for.end12:
// OPS-NEXT:    ret void
//
// OPZ-LABEL: @matrix_mul_const(
// OPZ-NEXT:  entry:
// OPZ-NEXT:    [[CONV4:%.*]] = sext i16 [[VAL:%.*]] to i32
// OPZ-NEXT:    [[WIDE_TRIP_COUNT:%.*]] = zext i32 [[N:%.*]] to i64
// OPZ-NEXT:    br label [[FOR_COND:%.*]]
// OPZ:       for.cond:
// OPZ-NEXT:    [[I_0:%.*]] = phi i32 [ 0, [[ENTRY:%.*]] ], [ [[INC11:%.*]], [[FOR_INC10:%.*]] ]
// OPZ-NEXT:    [[EXITCOND24_NOT:%.*]] = icmp eq i32 [[I_0]], [[N]]
// OPZ-NEXT:    br i1 [[EXITCOND24_NOT]], label [[FOR_END12:%.*]], label [[FOR_COND1_PREHEADER:%.*]]
// OPZ:       for.cond1.preheader:
// OPZ-NEXT:    [[MUL:%.*]] = mul i32 [[I_0]], [[N]]
// OPZ-NEXT:    br label [[FOR_COND1:%.*]]
// OPZ:       for.cond1:
// OPZ-NEXT:    [[INDVARS_IV:%.*]] = phi i64 [ 0, [[FOR_COND1_PREHEADER]] ], [ [[INDVARS_IV_NEXT:%.*]], [[FOR_BODY3:%.*]] ]
// OPZ-NEXT:    [[EXITCOND_NOT:%.*]] = icmp eq i64 [[INDVARS_IV]], [[WIDE_TRIP_COUNT]]
// OPZ-NEXT:    br i1 [[EXITCOND_NOT]], label [[FOR_INC10]], label [[FOR_BODY3]]
// OPZ:       for.body3:
// OPZ-NEXT:    [[TMP0:%.*]] = trunc i64 [[INDVARS_IV]] to i32
// OPZ-NEXT:    [[ADD:%.*]] = add i32 [[MUL]], [[TMP0]]
// OPZ-NEXT:    [[IDXPROM:%.*]] = zext i32 [[ADD]] to i64
// OPZ-NEXT:    [[ARRAYIDX:%.*]] = getelementptr inbounds i16, i16* [[A:%.*]], i64 [[IDXPROM]]
// OPZ-NEXT:    [[TMP1:%.*]] = load i16, i16* [[ARRAYIDX]], align 2, [[TBAA2:!tbaa !.*]]
// OPZ-NEXT:    [[CONV:%.*]] = sext i16 [[TMP1]] to i32
// OPZ-NEXT:    [[MUL5:%.*]] = mul nsw i32 [[CONV]], [[CONV4]]
// OPZ-NEXT:    [[ARRAYIDX9:%.*]] = getelementptr inbounds i32, i32* [[C:%.*]], i64 [[IDXPROM]]
// OPZ-NEXT:    store i32 [[MUL5]], i32* [[ARRAYIDX9]], align 4, [[TBAA6:!tbaa !.*]]
// OPZ-NEXT:    [[INDVARS_IV_NEXT]] = add nuw nsw i64 [[INDVARS_IV]], 1
// OPZ-NEXT:    br label [[FOR_COND1]], [[LOOP8:!llvm.loop !.*]]
// OPZ:       for.inc10:
// OPZ-NEXT:    [[INC11]] = add i32 [[I_0]], 1
// OPZ-NEXT:    br label [[FOR_COND]], [[LOOP10:!llvm.loop !.*]]
// OPZ:       for.end12:
// OPZ-NEXT:    ret void
//
// OP3-LABEL: @matrix_mul_const(
// OP3-NEXT:  entry:
// OP3-NEXT:    [[CMP26_NOT:%.*]] = icmp eq i32 [[N:%.*]], 0
// OP3-NEXT:    br i1 [[CMP26_NOT]], label [[FOR_END12:%.*]], label [[FOR_COND1_PREHEADER_LR_PH:%.*]]
// OP3:       for.cond1.preheader.lr.ph:
// OP3-NEXT:    [[CONV4:%.*]] = sext i16 [[VAL:%.*]] to i32
// OP3-NEXT:    [[WIDE_TRIP_COUNT:%.*]] = zext i32 [[N]] to i64
// OP3-NEXT:    [[TMP0:%.*]] = add nsw i64 [[WIDE_TRIP_COUNT]], -1
// OP3-NEXT:    [[XTRAITER:%.*]] = and i64 [[WIDE_TRIP_COUNT]], 7
// OP3-NEXT:    [[TMP1:%.*]] = icmp ult i64 [[TMP0]], 7
// OP3-NEXT:    [[UNROLL_ITER:%.*]] = and i64 [[WIDE_TRIP_COUNT]], 4294967288
// OP3-NEXT:    [[LCMP_MOD_NOT:%.*]] = icmp eq i64 [[XTRAITER]], 0
// OP3-NEXT:    [[EPIL_ITER_CMP_NOT:%.*]] = icmp eq i64 [[XTRAITER]], 1
// OP3-NEXT:    [[EPIL_ITER_CMP_1_NOT:%.*]] = icmp eq i64 [[XTRAITER]], 2
// OP3-NEXT:    [[EPIL_ITER_CMP_2_NOT:%.*]] = icmp eq i64 [[XTRAITER]], 3
// OP3-NEXT:    [[EPIL_ITER_CMP_3_NOT:%.*]] = icmp eq i64 [[XTRAITER]], 4
// OP3-NEXT:    [[EPIL_ITER_CMP_4_NOT:%.*]] = icmp eq i64 [[XTRAITER]], 5
// OP3-NEXT:    [[EPIL_ITER_CMP_5_NOT:%.*]] = icmp eq i64 [[XTRAITER]], 6
// OP3-NEXT:    br label [[FOR_COND1_PREHEADER_US:%.*]]
// OP3:       for.cond1.preheader.us:
// OP3-NEXT:    [[I_027_US:%.*]] = phi i32 [ 0, [[FOR_COND1_PREHEADER_LR_PH]] ], [ [[INC11_US:%.*]], [[FOR_COND1_FOR_INC10_CRIT_EDGE_US:%.*]] ]
// OP3-NEXT:    [[MUL_US:%.*]] = mul i32 [[I_027_US]], [[N]]
// OP3-NEXT:    br i1 [[TMP1]], label [[FOR_COND1_FOR_INC10_CRIT_EDGE_US_UNR_LCSSA:%.*]], label [[FOR_BODY3_US:%.*]]
// OP3:       for.body3.us:
// OP3-NEXT:    [[INDVARS_IV:%.*]] = phi i64 [ [[INDVARS_IV_NEXT_7:%.*]], [[FOR_BODY3_US]] ], [ 0, [[FOR_COND1_PREHEADER_US]] ]
// OP3-NEXT:    [[NITER:%.*]] = phi i64 [ [[NITER_NSUB_7:%.*]], [[FOR_BODY3_US]] ], [ [[UNROLL_ITER]], [[FOR_COND1_PREHEADER_US]] ]
// OP3-NEXT:    [[TMP2:%.*]] = trunc i64 [[INDVARS_IV]] to i32
// OP3-NEXT:    [[ADD_US:%.*]] = add i32 [[MUL_US]], [[TMP2]]
// OP3-NEXT:    [[IDXPROM_US:%.*]] = zext i32 [[ADD_US]] to i64
// OP3-NEXT:    [[ARRAYIDX_US:%.*]] = getelementptr inbounds i16, i16* [[A:%.*]], i64 [[IDXPROM_US]]
// OP3-NEXT:    [[TMP3:%.*]] = load i16, i16* [[ARRAYIDX_US]], align 2, [[TBAA2:!tbaa !.*]]
// OP3-NEXT:    [[CONV_US:%.*]] = sext i16 [[TMP3]] to i32
// OP3-NEXT:    [[MUL5_US:%.*]] = mul nsw i32 [[CONV_US]], [[CONV4]]
// OP3-NEXT:    [[ARRAYIDX9_US:%.*]] = getelementptr inbounds i32, i32* [[C:%.*]], i64 [[IDXPROM_US]]
// OP3-NEXT:    store i32 [[MUL5_US]], i32* [[ARRAYIDX9_US]], align 4, [[TBAA6:!tbaa !.*]]
// OP3-NEXT:    [[TMP4:%.*]] = trunc i64 [[INDVARS_IV]] to i32
// OP3-NEXT:    [[TMP5:%.*]] = or i32 [[TMP4]], 1
// OP3-NEXT:    [[ADD_US_1:%.*]] = add i32 [[MUL_US]], [[TMP5]]
// OP3-NEXT:    [[IDXPROM_US_1:%.*]] = zext i32 [[ADD_US_1]] to i64
// OP3-NEXT:    [[ARRAYIDX_US_1:%.*]] = getelementptr inbounds i16, i16* [[A]], i64 [[IDXPROM_US_1]]
// OP3-NEXT:    [[TMP6:%.*]] = load i16, i16* [[ARRAYIDX_US_1]], align 2, [[TBAA2]]
// OP3-NEXT:    [[CONV_US_1:%.*]] = sext i16 [[TMP6]] to i32
// OP3-NEXT:    [[MUL5_US_1:%.*]] = mul nsw i32 [[CONV_US_1]], [[CONV4]]
// OP3-NEXT:    [[ARRAYIDX9_US_1:%.*]] = getelementptr inbounds i32, i32* [[C]], i64 [[IDXPROM_US_1]]
// OP3-NEXT:    store i32 [[MUL5_US_1]], i32* [[ARRAYIDX9_US_1]], align 4, [[TBAA6]]
// OP3-NEXT:    [[TMP7:%.*]] = trunc i64 [[INDVARS_IV]] to i32
// OP3-NEXT:    [[TMP8:%.*]] = or i32 [[TMP7]], 2
// OP3-NEXT:    [[ADD_US_2:%.*]] = add i32 [[MUL_US]], [[TMP8]]
// OP3-NEXT:    [[IDXPROM_US_2:%.*]] = zext i32 [[ADD_US_2]] to i64
// OP3-NEXT:    [[ARRAYIDX_US_2:%.*]] = getelementptr inbounds i16, i16* [[A]], i64 [[IDXPROM_US_2]]
// OP3-NEXT:    [[TMP9:%.*]] = load i16, i16* [[ARRAYIDX_US_2]], align 2, [[TBAA2]]
// OP3-NEXT:    [[CONV_US_2:%.*]] = sext i16 [[TMP9]] to i32
// OP3-NEXT:    [[MUL5_US_2:%.*]] = mul nsw i32 [[CONV_US_2]], [[CONV4]]
// OP3-NEXT:    [[ARRAYIDX9_US_2:%.*]] = getelementptr inbounds i32, i32* [[C]], i64 [[IDXPROM_US_2]]
// OP3-NEXT:    store i32 [[MUL5_US_2]], i32* [[ARRAYIDX9_US_2]], align 4, [[TBAA6]]
// OP3-NEXT:    [[TMP10:%.*]] = trunc i64 [[INDVARS_IV]] to i32
// OP3-NEXT:    [[TMP11:%.*]] = or i32 [[TMP10]], 3
// OP3-NEXT:    [[ADD_US_3:%.*]] = add i32 [[MUL_US]], [[TMP11]]
// OP3-NEXT:    [[IDXPROM_US_3:%.*]] = zext i32 [[ADD_US_3]] to i64
// OP3-NEXT:    [[ARRAYIDX_US_3:%.*]] = getelementptr inbounds i16, i16* [[A]], i64 [[IDXPROM_US_3]]
// OP3-NEXT:    [[TMP12:%.*]] = load i16, i16* [[ARRAYIDX_US_3]], align 2, [[TBAA2]]
// OP3-NEXT:    [[CONV_US_3:%.*]] = sext i16 [[TMP12]] to i32
// OP3-NEXT:    [[MUL5_US_3:%.*]] = mul nsw i32 [[CONV_US_3]], [[CONV4]]
// OP3-NEXT:    [[ARRAYIDX9_US_3:%.*]] = getelementptr inbounds i32, i32* [[C]], i64 [[IDXPROM_US_3]]
// OP3-NEXT:    store i32 [[MUL5_US_3]], i32* [[ARRAYIDX9_US_3]], align 4, [[TBAA6]]
// OP3-NEXT:    [[TMP13:%.*]] = trunc i64 [[INDVARS_IV]] to i32
// OP3-NEXT:    [[TMP14:%.*]] = or i32 [[TMP13]], 4
// OP3-NEXT:    [[ADD_US_4:%.*]] = add i32 [[MUL_US]], [[TMP14]]
// OP3-NEXT:    [[IDXPROM_US_4:%.*]] = zext i32 [[ADD_US_4]] to i64
// OP3-NEXT:    [[ARRAYIDX_US_4:%.*]] = getelementptr inbounds i16, i16* [[A]], i64 [[IDXPROM_US_4]]
// OP3-NEXT:    [[TMP15:%.*]] = load i16, i16* [[ARRAYIDX_US_4]], align 2, [[TBAA2]]
// OP3-NEXT:    [[CONV_US_4:%.*]] = sext i16 [[TMP15]] to i32
// OP3-NEXT:    [[MUL5_US_4:%.*]] = mul nsw i32 [[CONV_US_4]], [[CONV4]]
// OP3-NEXT:    [[ARRAYIDX9_US_4:%.*]] = getelementptr inbounds i32, i32* [[C]], i64 [[IDXPROM_US_4]]
// OP3-NEXT:    store i32 [[MUL5_US_4]], i32* [[ARRAYIDX9_US_4]], align 4, [[TBAA6]]
// OP3-NEXT:    [[TMP16:%.*]] = trunc i64 [[INDVARS_IV]] to i32
// OP3-NEXT:    [[TMP17:%.*]] = or i32 [[TMP16]], 5
// OP3-NEXT:    [[ADD_US_5:%.*]] = add i32 [[MUL_US]], [[TMP17]]
// OP3-NEXT:    [[IDXPROM_US_5:%.*]] = zext i32 [[ADD_US_5]] to i64
// OP3-NEXT:    [[ARRAYIDX_US_5:%.*]] = getelementptr inbounds i16, i16* [[A]], i64 [[IDXPROM_US_5]]
// OP3-NEXT:    [[TMP18:%.*]] = load i16, i16* [[ARRAYIDX_US_5]], align 2, [[TBAA2]]
// OP3-NEXT:    [[CONV_US_5:%.*]] = sext i16 [[TMP18]] to i32
// OP3-NEXT:    [[MUL5_US_5:%.*]] = mul nsw i32 [[CONV_US_5]], [[CONV4]]
// OP3-NEXT:    [[ARRAYIDX9_US_5:%.*]] = getelementptr inbounds i32, i32* [[C]], i64 [[IDXPROM_US_5]]
// OP3-NEXT:    store i32 [[MUL5_US_5]], i32* [[ARRAYIDX9_US_5]], align 4, [[TBAA6]]
// OP3-NEXT:    [[TMP19:%.*]] = trunc i64 [[INDVARS_IV]] to i32
// OP3-NEXT:    [[TMP20:%.*]] = or i32 [[TMP19]], 6
// OP3-NEXT:    [[ADD_US_6:%.*]] = add i32 [[MUL_US]], [[TMP20]]
// OP3-NEXT:    [[IDXPROM_US_6:%.*]] = zext i32 [[ADD_US_6]] to i64
// OP3-NEXT:    [[ARRAYIDX_US_6:%.*]] = getelementptr inbounds i16, i16* [[A]], i64 [[IDXPROM_US_6]]
// OP3-NEXT:    [[TMP21:%.*]] = load i16, i16* [[ARRAYIDX_US_6]], align 2, [[TBAA2]]
// OP3-NEXT:    [[CONV_US_6:%.*]] = sext i16 [[TMP21]] to i32
// OP3-NEXT:    [[MUL5_US_6:%.*]] = mul nsw i32 [[CONV_US_6]], [[CONV4]]
// OP3-NEXT:    [[ARRAYIDX9_US_6:%.*]] = getelementptr inbounds i32, i32* [[C]], i64 [[IDXPROM_US_6]]
// OP3-NEXT:    store i32 [[MUL5_US_6]], i32* [[ARRAYIDX9_US_6]], align 4, [[TBAA6]]
// OP3-NEXT:    [[TMP22:%.*]] = trunc i64 [[INDVARS_IV]] to i32
// OP3-NEXT:    [[TMP23:%.*]] = or i32 [[TMP22]], 7
// OP3-NEXT:    [[ADD_US_7:%.*]] = add i32 [[MUL_US]], [[TMP23]]
// OP3-NEXT:    [[IDXPROM_US_7:%.*]] = zext i32 [[ADD_US_7]] to i64
// OP3-NEXT:    [[ARRAYIDX_US_7:%.*]] = getelementptr inbounds i16, i16* [[A]], i64 [[IDXPROM_US_7]]
// OP3-NEXT:    [[TMP24:%.*]] = load i16, i16* [[ARRAYIDX_US_7]], align 2, [[TBAA2]]
// OP3-NEXT:    [[CONV_US_7:%.*]] = sext i16 [[TMP24]] to i32
// OP3-NEXT:    [[MUL5_US_7:%.*]] = mul nsw i32 [[CONV_US_7]], [[CONV4]]
// OP3-NEXT:    [[ARRAYIDX9_US_7:%.*]] = getelementptr inbounds i32, i32* [[C]], i64 [[IDXPROM_US_7]]
// OP3-NEXT:    store i32 [[MUL5_US_7]], i32* [[ARRAYIDX9_US_7]], align 4, [[TBAA6]]
// OP3-NEXT:    [[INDVARS_IV_NEXT_7]] = add nuw nsw i64 [[INDVARS_IV]], 8
// OP3-NEXT:    [[NITER_NSUB_7]] = add i64 [[NITER]], -8
// OP3-NEXT:    [[NITER_NCMP_7:%.*]] = icmp eq i64 [[NITER_NSUB_7]], 0
// OP3-NEXT:    br i1 [[NITER_NCMP_7]], label [[FOR_COND1_FOR_INC10_CRIT_EDGE_US_UNR_LCSSA]], label [[FOR_BODY3_US]], [[LOOP8:!llvm.loop !.*]]
// OP3:       for.cond1.for.inc10_crit_edge.us.unr-lcssa:
// OP3-NEXT:    [[INDVARS_IV_UNR:%.*]] = phi i64 [ 0, [[FOR_COND1_PREHEADER_US]] ], [ [[INDVARS_IV_NEXT_7]], [[FOR_BODY3_US]] ]
// OP3-NEXT:    br i1 [[LCMP_MOD_NOT]], label [[FOR_COND1_FOR_INC10_CRIT_EDGE_US]], label [[FOR_BODY3_US_EPIL:%.*]]
// OP3:       for.body3.us.epil:
// OP3-NEXT:    [[TMP25:%.*]] = trunc i64 [[INDVARS_IV_UNR]] to i32
// OP3-NEXT:    [[ADD_US_EPIL:%.*]] = add i32 [[MUL_US]], [[TMP25]]
// OP3-NEXT:    [[IDXPROM_US_EPIL:%.*]] = zext i32 [[ADD_US_EPIL]] to i64
// OP3-NEXT:    [[ARRAYIDX_US_EPIL:%.*]] = getelementptr inbounds i16, i16* [[A]], i64 [[IDXPROM_US_EPIL]]
// OP3-NEXT:    [[TMP26:%.*]] = load i16, i16* [[ARRAYIDX_US_EPIL]], align 2, [[TBAA2]]
// OP3-NEXT:    [[CONV_US_EPIL:%.*]] = sext i16 [[TMP26]] to i32
// OP3-NEXT:    [[MUL5_US_EPIL:%.*]] = mul nsw i32 [[CONV_US_EPIL]], [[CONV4]]
// OP3-NEXT:    [[ARRAYIDX9_US_EPIL:%.*]] = getelementptr inbounds i32, i32* [[C]], i64 [[IDXPROM_US_EPIL]]
// OP3-NEXT:    store i32 [[MUL5_US_EPIL]], i32* [[ARRAYIDX9_US_EPIL]], align 4, [[TBAA6]]
// OP3-NEXT:    br i1 [[EPIL_ITER_CMP_NOT]], label [[FOR_COND1_FOR_INC10_CRIT_EDGE_US]], label [[FOR_BODY3_US_EPIL_1:%.*]]
// OP3:       for.cond1.for.inc10_crit_edge.us:
// OP3-NEXT:    [[INC11_US]] = add nuw i32 [[I_027_US]], 1
// OP3-NEXT:    [[EXITCOND29_NOT:%.*]] = icmp eq i32 [[INC11_US]], [[N]]
// OP3-NEXT:    br i1 [[EXITCOND29_NOT]], label [[FOR_END12]], label [[FOR_COND1_PREHEADER_US]], [[LOOP10:!llvm.loop !.*]]
// OP3:       for.end12:
// OP3-NEXT:    ret void
// OP3:       for.body3.us.epil.1:
// OP3-NEXT:    [[TMP27:%.*]] = trunc i64 [[INDVARS_IV_UNR]] to i32
// OP3-NEXT:    [[TMP28:%.*]] = add i32 [[TMP27]], 1
// OP3-NEXT:    [[ADD_US_EPIL_1:%.*]] = add i32 [[MUL_US]], [[TMP28]]
// OP3-NEXT:    [[IDXPROM_US_EPIL_1:%.*]] = zext i32 [[ADD_US_EPIL_1]] to i64
// OP3-NEXT:    [[ARRAYIDX_US_EPIL_1:%.*]] = getelementptr inbounds i16, i16* [[A]], i64 [[IDXPROM_US_EPIL_1]]
// OP3-NEXT:    [[TMP29:%.*]] = load i16, i16* [[ARRAYIDX_US_EPIL_1]], align 2, [[TBAA2]]
// OP3-NEXT:    [[CONV_US_EPIL_1:%.*]] = sext i16 [[TMP29]] to i32
// OP3-NEXT:    [[MUL5_US_EPIL_1:%.*]] = mul nsw i32 [[CONV_US_EPIL_1]], [[CONV4]]
// OP3-NEXT:    [[ARRAYIDX9_US_EPIL_1:%.*]] = getelementptr inbounds i32, i32* [[C]], i64 [[IDXPROM_US_EPIL_1]]
// OP3-NEXT:    store i32 [[MUL5_US_EPIL_1]], i32* [[ARRAYIDX9_US_EPIL_1]], align 4, [[TBAA6]]
// OP3-NEXT:    br i1 [[EPIL_ITER_CMP_1_NOT]], label [[FOR_COND1_FOR_INC10_CRIT_EDGE_US]], label [[FOR_BODY3_US_EPIL_2:%.*]]
// OP3:       for.body3.us.epil.2:
// OP3-NEXT:    [[TMP30:%.*]] = trunc i64 [[INDVARS_IV_UNR]] to i32
// OP3-NEXT:    [[TMP31:%.*]] = add i32 [[TMP30]], 2
// OP3-NEXT:    [[ADD_US_EPIL_2:%.*]] = add i32 [[MUL_US]], [[TMP31]]
// OP3-NEXT:    [[IDXPROM_US_EPIL_2:%.*]] = zext i32 [[ADD_US_EPIL_2]] to i64
// OP3-NEXT:    [[ARRAYIDX_US_EPIL_2:%.*]] = getelementptr inbounds i16, i16* [[A]], i64 [[IDXPROM_US_EPIL_2]]
// OP3-NEXT:    [[TMP32:%.*]] = load i16, i16* [[ARRAYIDX_US_EPIL_2]], align 2, [[TBAA2]]
// OP3-NEXT:    [[CONV_US_EPIL_2:%.*]] = sext i16 [[TMP32]] to i32
// OP3-NEXT:    [[MUL5_US_EPIL_2:%.*]] = mul nsw i32 [[CONV_US_EPIL_2]], [[CONV4]]
// OP3-NEXT:    [[ARRAYIDX9_US_EPIL_2:%.*]] = getelementptr inbounds i32, i32* [[C]], i64 [[IDXPROM_US_EPIL_2]]
// OP3-NEXT:    store i32 [[MUL5_US_EPIL_2]], i32* [[ARRAYIDX9_US_EPIL_2]], align 4, [[TBAA6]]
// OP3-NEXT:    br i1 [[EPIL_ITER_CMP_2_NOT]], label [[FOR_COND1_FOR_INC10_CRIT_EDGE_US]], label [[FOR_BODY3_US_EPIL_3:%.*]]
// OP3:       for.body3.us.epil.3:
// OP3-NEXT:    [[TMP33:%.*]] = trunc i64 [[INDVARS_IV_UNR]] to i32
// OP3-NEXT:    [[TMP34:%.*]] = add i32 [[TMP33]], 3
// OP3-NEXT:    [[ADD_US_EPIL_3:%.*]] = add i32 [[MUL_US]], [[TMP34]]
// OP3-NEXT:    [[IDXPROM_US_EPIL_3:%.*]] = zext i32 [[ADD_US_EPIL_3]] to i64
// OP3-NEXT:    [[ARRAYIDX_US_EPIL_3:%.*]] = getelementptr inbounds i16, i16* [[A]], i64 [[IDXPROM_US_EPIL_3]]
// OP3-NEXT:    [[TMP35:%.*]] = load i16, i16* [[ARRAYIDX_US_EPIL_3]], align 2, [[TBAA2]]
// OP3-NEXT:    [[CONV_US_EPIL_3:%.*]] = sext i16 [[TMP35]] to i32
// OP3-NEXT:    [[MUL5_US_EPIL_3:%.*]] = mul nsw i32 [[CONV_US_EPIL_3]], [[CONV4]]
// OP3-NEXT:    [[ARRAYIDX9_US_EPIL_3:%.*]] = getelementptr inbounds i32, i32* [[C]], i64 [[IDXPROM_US_EPIL_3]]
// OP3-NEXT:    store i32 [[MUL5_US_EPIL_3]], i32* [[ARRAYIDX9_US_EPIL_3]], align 4, [[TBAA6]]
// OP3-NEXT:    br i1 [[EPIL_ITER_CMP_3_NOT]], label [[FOR_COND1_FOR_INC10_CRIT_EDGE_US]], label [[FOR_BODY3_US_EPIL_4:%.*]]
// OP3:       for.body3.us.epil.4:
// OP3-NEXT:    [[TMP36:%.*]] = trunc i64 [[INDVARS_IV_UNR]] to i32
// OP3-NEXT:    [[TMP37:%.*]] = add i32 [[TMP36]], 4
// OP3-NEXT:    [[ADD_US_EPIL_4:%.*]] = add i32 [[MUL_US]], [[TMP37]]
// OP3-NEXT:    [[IDXPROM_US_EPIL_4:%.*]] = zext i32 [[ADD_US_EPIL_4]] to i64
// OP3-NEXT:    [[ARRAYIDX_US_EPIL_4:%.*]] = getelementptr inbounds i16, i16* [[A]], i64 [[IDXPROM_US_EPIL_4]]
// OP3-NEXT:    [[TMP38:%.*]] = load i16, i16* [[ARRAYIDX_US_EPIL_4]], align 2, [[TBAA2]]
// OP3-NEXT:    [[CONV_US_EPIL_4:%.*]] = sext i16 [[TMP38]] to i32
// OP3-NEXT:    [[MUL5_US_EPIL_4:%.*]] = mul nsw i32 [[CONV_US_EPIL_4]], [[CONV4]]
// OP3-NEXT:    [[ARRAYIDX9_US_EPIL_4:%.*]] = getelementptr inbounds i32, i32* [[C]], i64 [[IDXPROM_US_EPIL_4]]
// OP3-NEXT:    store i32 [[MUL5_US_EPIL_4]], i32* [[ARRAYIDX9_US_EPIL_4]], align 4, [[TBAA6]]
// OP3-NEXT:    br i1 [[EPIL_ITER_CMP_4_NOT]], label [[FOR_COND1_FOR_INC10_CRIT_EDGE_US]], label [[FOR_BODY3_US_EPIL_5:%.*]]
// OP3:       for.body3.us.epil.5:
// OP3-NEXT:    [[TMP39:%.*]] = trunc i64 [[INDVARS_IV_UNR]] to i32
// OP3-NEXT:    [[TMP40:%.*]] = add i32 [[TMP39]], 5
// OP3-NEXT:    [[ADD_US_EPIL_5:%.*]] = add i32 [[MUL_US]], [[TMP40]]
// OP3-NEXT:    [[IDXPROM_US_EPIL_5:%.*]] = zext i32 [[ADD_US_EPIL_5]] to i64
// OP3-NEXT:    [[ARRAYIDX_US_EPIL_5:%.*]] = getelementptr inbounds i16, i16* [[A]], i64 [[IDXPROM_US_EPIL_5]]
// OP3-NEXT:    [[TMP41:%.*]] = load i16, i16* [[ARRAYIDX_US_EPIL_5]], align 2, [[TBAA2]]
// OP3-NEXT:    [[CONV_US_EPIL_5:%.*]] = sext i16 [[TMP41]] to i32
// OP3-NEXT:    [[MUL5_US_EPIL_5:%.*]] = mul nsw i32 [[CONV_US_EPIL_5]], [[CONV4]]
// OP3-NEXT:    [[ARRAYIDX9_US_EPIL_5:%.*]] = getelementptr inbounds i32, i32* [[C]], i64 [[IDXPROM_US_EPIL_5]]
// OP3-NEXT:    store i32 [[MUL5_US_EPIL_5]], i32* [[ARRAYIDX9_US_EPIL_5]], align 4, [[TBAA6]]
// OP3-NEXT:    br i1 [[EPIL_ITER_CMP_5_NOT]], label [[FOR_COND1_FOR_INC10_CRIT_EDGE_US]], label [[FOR_BODY3_US_EPIL_6:%.*]]
// OP3:       for.body3.us.epil.6:
// OP3-NEXT:    [[TMP42:%.*]] = trunc i64 [[INDVARS_IV_UNR]] to i32
// OP3-NEXT:    [[TMP43:%.*]] = add i32 [[TMP42]], 6
// OP3-NEXT:    [[ADD_US_EPIL_6:%.*]] = add i32 [[MUL_US]], [[TMP43]]
// OP3-NEXT:    [[IDXPROM_US_EPIL_6:%.*]] = zext i32 [[ADD_US_EPIL_6]] to i64
// OP3-NEXT:    [[ARRAYIDX_US_EPIL_6:%.*]] = getelementptr inbounds i16, i16* [[A]], i64 [[IDXPROM_US_EPIL_6]]
// OP3-NEXT:    [[TMP44:%.*]] = load i16, i16* [[ARRAYIDX_US_EPIL_6]], align 2, [[TBAA2]]
// OP3-NEXT:    [[CONV_US_EPIL_6:%.*]] = sext i16 [[TMP44]] to i32
// OP3-NEXT:    [[MUL5_US_EPIL_6:%.*]] = mul nsw i32 [[CONV_US_EPIL_6]], [[CONV4]]
// OP3-NEXT:    [[ARRAYIDX9_US_EPIL_6:%.*]] = getelementptr inbounds i32, i32* [[C]], i64 [[IDXPROM_US_EPIL_6]]
// OP3-NEXT:    store i32 [[MUL5_US_EPIL_6]], i32* [[ARRAYIDX9_US_EPIL_6]], align 4, [[TBAA6]]
// OP3-NEXT:    br label [[FOR_COND1_FOR_INC10_CRIT_EDGE_US]]
//
void matrix_mul_const(unsigned int N, signed int *C, signed short *A, signed short val)
{
    unsigned int i, j;
    for (i = 0; i < N; i++)
    {
        for (j = 0; j < N; j++)
        {
            C[i * N + j] = (signed int)A[i * N + j] * (signed int)val;
        }
    }
}

















